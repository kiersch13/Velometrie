<h2 class="text-2xl font-bold text-primary dark:text-text-dark mb-6">Einstellungen</h2>

<div class="bg-white dark:bg-bg-dark rounded-xl p-7 shadow-sm max-w-lg">
  <h3 class="text-base font-semibold text-primary dark:text-text-dark mb-4">Strava-Verbindung</h3>

  <!-- Status badge -->
  <div class="flex items-center gap-2 mb-6">
    <span *ngIf="authService.isConnected"
          class="inline-flex items-center gap-1.5 text-sm font-medium text-success">
      <span class="inline-block w-2 h-2 rounded-full bg-success"></span>
      Verbunden
    </span>
    <span *ngIf="!authService.isConnected"
          class="inline-flex items-center gap-1.5 text-sm font-medium text-gray-500">
      <span class="inline-block w-2 h-2 rounded-full bg-gray-400"></span>
      Nicht verbunden
    </span>
  </div>

  <!-- Connected view -->
  <div *ngIf="authService.isConnected">
    <div class="flex flex-col gap-1 mb-5 text-sm text-gray-600 dark:text-text-dark">
      <span class="text-xs font-semibold text-gray-400 uppercase tracking-wider">Strava-ID</span>
      <span class="font-mono">{{ authService.currentUser?.stravaId }}</span>
    </div>
    <button
      class="bg-error hover:bg-error/90 disabled:opacity-60 text-white font-semibold rounded-lg px-4 py-2 text-sm cursor-pointer transition-colors duration-150"
      [disabled]="loading"
      (click)="disconnect()">
      {{ loading ? 'Wird getrennt...' : 'Strava trennen' }}
    </button>
  </div>

  <!-- Disconnected view -->
  <form *ngIf="!authService.isConnected" (ngSubmit)="connect()">
    <div class="flex flex-col gap-1.5 mb-4">
      <label for="stravaId" class="text-xs font-semibold text-gray-500 dark:text-text-dark">Strava-ID</label>
      <input id="stravaId" type="text" [(ngModel)]="stravaId" name="stravaId"
             placeholder="Deine Strava-ID"
             class="px-3 py-2 border border-gray-200 focus:border-accent rounded-lg text-base outline-none transition-colors duration-150 dark:bg-bg-dark dark:text-text-dark" />
    </div>

    <div class="flex flex-col gap-1.5 mb-5">
      <label for="accessToken" class="text-xs font-semibold text-gray-500 dark:text-text-dark">Access-Token</label>
      <input id="accessToken" type="password" [(ngModel)]="accessToken" name="accessToken"
             placeholder="Strava Access-Token"
             class="px-3 py-2 border border-gray-200 focus:border-accent rounded-lg text-base outline-none transition-colors duration-150 dark:bg-bg-dark dark:text-text-dark" />
    </div>

    <button type="submit"
            class="bg-accent hover:bg-accent/90 disabled:opacity-60 disabled:cursor-not-allowed text-white font-semibold rounded-lg px-4 py-2 text-sm cursor-pointer transition-colors duration-150"
            [disabled]="loading">
      {{ loading ? 'Verbinde...' : 'Mit Strava verbinden' }}
    </button>
  </form>

  <!-- Feedback messages -->
  <p *ngIf="error" class="mt-4 text-sm text-error">{{ error }}</p>
  <p *ngIf="success" class="mt-4 text-sm text-success">{{ success }}</p>
</div>
